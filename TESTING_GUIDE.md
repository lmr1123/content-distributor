# 🧪 测试指南

## 测试前准备

### 1. 重新加载扩展

如果之前已安装，需要重新加载：

1. 打开 `chrome://extensions/`
2. 找到"全平台内容分发助手"
3. 点击刷新图标 🔄
4. 或删除后重新加载

### 2. 验证 CSP 修复

```bash
./verify-csp-fix.sh
```

应该看到所有 ✅ 通过

## 功能测试清单

### ✅ 基础功能测试

#### 1. 页面加载测试
- [ ] 点击扩展图标能打开独立页面
- [ ] 页面布局正常显示（左侧输入区，右侧编辑器）
- [ ] 底部平台选择正常显示
- [ ] 控制台无错误信息

#### 2. 富文本编辑器测试
- [ ] 编辑器工具栏正常显示
- [ ] 可以输入文字
- [ ] 可以设置文字格式（粗体、斜体等）
- [ ] 可以插入链接
- [ ] 字数统计正常工作

#### 3. 文章导入测试（需要真实的微信文章链接）
- [ ] 输入微信文章链接
- [ ] 点击"获取内容"按钮
- [ ] 显示加载状态
- [ ] 成功提取标题
- [ ] 成功提取正文到编辑器
- [ ] 字数统计更新

#### 4. 平台选择测试
- [ ] 可以勾选/取消勾选平台
- [ ] "已选择 X 个平台"计数正确
- [ ] 同步按钮状态正确（未选择时禁用）

#### 5. 同步功能测试
- [ ] 选择平台后同步按钮启用
- [ ] 点击同步按钮打开新标签页
- [ ] 打开正确的平台发布页面

### ✅ 自动填充测试

需要在各平台测试自动填充（需要登录）：

#### 小红书
- [ ] 打开发布页面
- [ ] 等待内容自动填充
- [ ] 检查标题是否正确
- [ ] 检查正文是否填充

#### 知乎
- [ ] 打开写文章页面
- [ ] 等待内容自动填充
- [ ] 检查格式是否保留

#### 其他平台
- [ ] 简书
- [ ] 今日头条
- [ ] 哔哩哔哩

### ✅ 本地存储测试

- [ ] 编辑内容后刷新页面
- [ ] 检查内容是否保留
- [ ] 测试自动保存功能

## 性能测试

### 页面加载性能
```javascript
// 在控制台执行
console.time('page-load');
location.reload();
// 页面加载完成后
console.timeEnd('page-load');
// 应该 < 1秒
```

### 内存使用
```javascript
// 检查内存使用
console.log(performance.memory);
```

## 常见问题排查

### 问题1: 编辑器不显示

**检查**:
```bash
# 验证文件存在
ls -l js/lib/quill.min.js css/quill.snow.css
```

**解决**: 运行 `./verify-csp-fix.sh`

### 问题2: 控制台有 CSP 错误

**检查**:
- 打开开发者工具 (F12)
- 查看 Console 标签
- 查找红色错误信息

**解决**: 确保使用本地文件，不是 CDN

### 问题3: 无法获取微信文章

**可能原因**:
- 链接格式不正确
- 文章需要登录
- 网络问题

**测试链接**:
使用一篇公开的微信文章测试

## 自动化测试

### 运行测试脚本
```bash
# 完整测试
./quick-start.sh

# CSP 验证
./verify-csp-fix.sh

# 打开测试页面
open test-extension.html
```

### 浏览器测试
```bash
# 打开功能演示
open DEMO.html

# 打开测试工具
open test-extension.html
```

## 回归测试清单

每次更新后测试：

1. [ ] 扩展能正常加载
2. [ ] 页面正常显示
3. [ ] 编辑器功能正常
4. [ ] 文章提取正常
5. [ ] 平台选择正常
6. [ ] 同步功能正常
7. [ ] 无控制台错误
8. [ ] 无 CSP 警告

## 测试报告模板

```markdown
## 测试报告 - [日期]

### 环境
- Chrome 版本: 
- 操作系统: 
- 扩展版本: 1.0.0

### 测试结果
- 页面加载: ✅ / ❌
- 编辑器: ✅ / ❌
- 文章提取: ✅ / ❌
- 平台同步: ✅ / ❌
- 自动填充: ✅ / ❌

### 问题描述
[如有问题，在此描述]

### 截图
[附上截图]
```

---

**最后更新**: 2025-02-12
**状态**: ✅ CSP 已修复，可正常测试
